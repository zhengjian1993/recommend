<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hjucook.recommend.mapper.buried.BuriedMapper">
    <resultMap id="targetClick" type="com.hjucook.recommend.model.entity.buried.TargetClick">
        <result column="target_id" property="targetId"/>
        <result column="target_type" property="targetType"/>
        <result column="name" property="name"/>
        <result column="gmt_create" property="gmtCreate"/>
    </resultMap>

    <resultMap id="targetDuration" type="com.hjucook.recommend.model.entity.buried.TargetDuration">
        <result column="target_id" property="targetId"/>
        <result column="target_type" property="targetType"/>
        <result column="duration" property="duration"/>
    </resultMap>

    <select id="listTargetClick" resultMap="targetClick">
        select target_id, name, gmt_create from dim_mine_click_record
        where target_id &gt; 0
        <if test="userId != null">
            and user_id = #{userId}
        </if>
        order by id DESC limit #{num};
    </select>


    <select id="listTargetDuration" resultMap="targetDuration">
        select target_id, sum(duration) as duration from dim_mine_page_record
        where duration &lt; 10000000 and target_id &gt; 0
        <if test="userId != null">
            and user_id = #{userId}
        </if>
        group by target_id order by id desc limit #{num};
    </select>


</mapper>